(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{829:function(e,t,a){"use strict";a.r(t),function(e){a(2),a(3),a(4),a(5),a(379),a(72),a(366),a(376),a(79),a(206),a(364),a(204),a(20),a(367),a(103),a(99),a(31),a(297),a(98),a(307),a(205),a(15),a(16),a(12),a(13),a(9),a(10),a(14),a(11);var n=a(0),r=(a(320),a(794),a(795),a(796),a(798),a(176)),o=a(177);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(r=n.key,o=void 0,o=function(e,t){if("object"!==c(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===c(o)?o:String(o)),n)}var r,o}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=u(e);if(t){var r=u(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return d(this,a)}}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(h,t);var a,d,u,f=s(h);function h(t){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(a=f.call(this,t)).el=e(a.element),a.hasCheckboxes=a.el.hasClass("table-selectable"),a.hasClearState=a.el.hasClass("table-clear-state"),a.searchParams=new URLSearchParams(window.location.search),a.initTable(),a}return a=h,(d=[{key:"initTable",value:function(){if(this.hasClearState){this.clearTableStateForPage();var t=new URL(window.location.href);t.searchParams.delete("table_clear_state");var a=t.toString();window.location.replace(a.endsWith("?")?a.slice(0,-1):a)}else{var n=this.getConf();this.el.DataTable(n),this.hasCheckboxes&&this.addSelectAllCheckbox(),this.el.hasClass("table-account-requests")&&(this.modal=e.find("#userModal"),this.initClickableTable()),e(this.el).on("childRow.dt",(function(t,a,n){var c=e(n.child()),i=c.find(".record-popup");Object(r.b)(c),i.each((function(e,t){new o.a(t)}))}))}}},{key:"clearTableStateForPage",value:function(){for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);if(t.startsWith("DataTables")){var a=t.split("/");!a||a.length<=1||-1!==window.location.href.indexOf("/"+a.slice(1).join("/"))&&localStorage.removeItem(t)}}}},{key:"initClickableTable",value:function(){var e=this,t=this.el.find("tbody td .link");t.on("click",(function(t){e.handleClick(t)})),t.on("focus",(function(t){e.toggleFocus(t,!0)})),t.on("blur",(function(t){e.toggleFocus(t,!1)}))}},{key:"toggleFocus",value:function(t,a){var n=e(t.target).closest("tr");a?n.addClass("tr--focus"):n.removeClass("tr--focus")}},{key:"handleClick",value:function(t){var a=e(t.target).closest("tr");t.preventDefault(),this.fillModalData(a),e(this.modal).modal("show")}},{key:"fillModalData",value:function(t){var a=e(this.modal).find("input"),n=e(this.modal).find(".btn-js-reject-request"),r=parseInt(e(t).find("td[data-id]").data("id"),10);r&&(e(this.modal).data("config").id=r),n&&r&&!isNaN(r)&&n.val(r),a.each((function(a,n){var r=e(n).attr("name"),o=e(t).find("td[data-".concat(r,"]")).data(r);o&&(e(n).val(o),e(n).data("original-value",o),e(n).trigger("change"))}))}},{key:"getCheckboxElement",value:function(e,t){return"<div class='checkbox'>"+"<input id='dt_checkbox_".concat(e,"' type='checkbox' />")+"<label for='dt_checkbox_".concat(e,"'><span>").concat(t,"</span></label>")+"</div>"}},{key:"addSelectAllCheckbox",value:function(){var t=this,a=this.el.find("thead th.check"),n=this.el.find("tbody .check .checkbox input");a.length&&a.html(this.getCheckboxElement("all","Select all")),this.checkSelectAll(n,a.find("input")),n.on("click",(function(e){t.checkSelectAll(n,a.find("input"))})),a.find("input").on("click",(function(a){var r=e(a.target);e(r).is(":checked")?t.checkAllCheckboxes(n,!0):t.checkAllCheckboxes(n,!1)}))}},{key:"checkAllCheckboxes",value:function(e,t){t?e.prop("checked",!0):e.prop("checked",!1)}},{key:"checkSelectAll",value:function(e,t){var a=!0;e.each((function(e,n){if(!n.checked)return t.prop("checked",!1),void(a=!1)})),a&&t.prop("checked",!0)}},{key:"addSortButton",value:function(t,a){var n=e(a.header()),r=e('\n      <button class="data-table__sort" type="button">\n        <span>'.concat(n.html(),'</span>\n        <span class="btn btn-sort">\n          <span>Sort</span>\n        </span>\n      </button>'));n.off().find(".data-table__header-wrapper").html(r),t.order.listener(r,a.index())}},{key:"toggleFilter",value:function(t){var a=e(t.header());""!==t.search()?(a.find(".data-table__header-wrapper").addClass("filter"),a.find(".data-table__clear").show()):(a.find(".data-table__header-wrapper").removeClass("filter"),a.find(".data-table__clear").hide())}},{key:"addSearchDropdown",value:function(t,a,n){var r=e(t.header()),o=r.text().trim(),c=t.search(),i=this,l=e("<div class='data-table__search'>\n        <button\n          class='btn btn-search dropdown-toggle'\n          id='search-toggle-".concat(n,"'\n          type='button'\n          data-toggle='dropdown'\n          aria-expanded='false'\n          data-boundary='viewport'\n          data-reference='parent'\n          data-target=\"[data-ddl='ddl_").concat(n,"']\"\n          data-focus=\"[data-ddl='ddl_").concat(n,"']\"\n        >\n          <span>Search in ").concat(o,"</span>\n        </button>\n        <div class='dropdown-menu p-2' aria-labelledby='search-toggle-").concat(n,"'>\n          <label>\n            <div class='input'>\n              <input class='form-control form-control-sm' type='text' placeholder='Search' value='").concat(c,"'/>\n            </div>\n          </label>\n          <button type='button' class='btn btn-link btn-small data-table__clear hidden'>\n            <span>Clear filter</span>\n          </button>\n        </div>\n      </div>"));r.find(".data-table__header-wrapper").prepend(l),this.toggleFilter(t),e("input",r).on("change",(function(){t.search()!==this.value&&t.search(this.value).draw(),i.toggleFilter(t),i.searchParams.has(a)?i.searchParams.set(a,this.value):i.searchParams.append(a,this.value),window.location.href="".concat(window.location.href.split("?")[0],"?").concat(i.searchParams.toString())})),e(".data-table__clear",r).on("click",(function(){if(e(this).closest(".input").find("input").val(""),t.search("").draw(),i.searchParams.has(a)){i.searchParams.delete(a);var n="".concat(window.location.href.split("?")[0]);void 0!==i.searchParams.entries().next().value&&(n+="?".concat(i.searchParams.toString())),window.location.href=n}}))}},{key:"encodeHTMLEntities",value:function(t){return e("<textarea/>").text(t).html()}},{key:"decodeHTMLEntities",value:function(t){return e("<textarea/>").html(t).text()}},{key:"renderMoreLess",value:function(e,t){return e.toString().length>50?'<div class="more-less" data-column="'.concat(t,'">\n          ').concat(e,"\n        </div>"):e}},{key:"renderDefault",value:function(e,t){var a=this,n="";return e.values&&e.values.length?(e.values.forEach((function(t,r){n+=a.encodeHTMLEntities(t),n+=e.values.length>r+1?", ":""})),this.renderMoreLess(n,t)):n}},{key:"renderPerson",value:function(e){var t=this,a="";if(!e.values.length)return a;var n=e.values[0];return n.details.length&&(a+="<div>",n.details.forEach((function(e){var n=t.encodeHTMLEntities(e.value);"email"===e.type?a+='<p>E-mail: <a href="mailto:'.concat(n,'">').concat(n,"</a></p>"):a+="<p>".concat(t.encodeHTMLEntities(e.definition),": ").concat(n,"</p>")})),a+="</div>"),'<button class="btn btn-small btn-inverted btn-info trigger" aria-expanded="false" type="button">\n        '.concat(this.encodeHTMLEntities(n.text),'\n        <span class="invisible">contact details</span>\n      </button>\n      <div class="person contact-details expandable popover card card--secundary">\n        ').concat(a,"\n      </div>")}},{key:"renderFile",value:function(e){var t=this,a="";return e.values.length?(e.values.forEach((function(e){a+='<a href="/file/'.concat(e.id,'">'),e.mimetype.match("^image/")?a+='<img class="autosize" src="/file/'.concat(e.id,'"></img>'):a+="".concat(t.encodeHTMLEntities(e.name),"<br>"),a+="</a>"})),a):a}},{key:"renderRag",value:function(e){var t="";return t=e.values.length&&{a_grey:"undefined",b_red:"danger",b_attention:"attention",c_amber:"warning",c_yellow:"advisory",d_green:"success",d_blue:"complete",e_purple:"unexpected"}[e.values[0]]||"blank",'<span class="rag rag--'.concat(t,'" title="').concat(t,'" aria-labelledby="rag_').concat(t,'_meaning"><span>âœ—</span></span>')}},{key:"renderCurCommon",value:function(e){var t="";return 0===e.values.length?t:(t=this.renderCurCommonTable(e),this.renderMoreLess(t,e.name))}},{key:"renderCurCommonTable",value:function(e){var t=this,a="";return 0===e.values.length||0===e.values[0].fields.length||(a+='<table class="table-curcommon">',e.values.forEach((function(e){a+='<tr role="button" tabindex="0" class="link record-popup" data-record-id="'.concat(e.record_id,'"'),e.version_id&&(a+='data-version-id="'.concat(e.version_id,'"')),a+=">",e.status&&(a+="<td><em>".concat(e.status,":</em></td>")),e.fields.forEach((function(e){a+='<td class="'.concat(e.type,'">').concat(t.renderDataType(e,e.name),"</td>")})),a+="</tr>"})),a+="</table>",e.limit_rows&&e.values.length>=e.limit_rows&&(a+="<p><em>(showing maximum ".concat(e.limit_rows,' rows.\n          <a href="/').concat(e.parent_layout_identifier,"/data?curval_record_id=").concat(e.curval_record_id,"&curval_layout_id=").concat(e.column_id,'">view all</a>)</em>\n        </p>'))),a}},{key:"renderDataType",value:function(e,t){switch(e.type){case"person":case"createdby":return this.renderPerson(e);case"curval":case"autocur":case"filval":return this.renderCurCommon(e);case"file":return this.renderFile(e);case"rag":return this.renderRag(e);default:return this.renderDefault(e,t)}}},{key:"renderData",value:function(e,t,a){var n=a?a.settings.oAjaxData.columns[a.col].name:"",r=t[n];return"object"!==c(r)?"":this.renderDataType(r,n)}},{key:"getConf",value:function(){var t=this,a=this.el.data("config"),n={};return"string"==typeof a?n=JSON.parse(a):"object"===c(a)&&(n=a),n.serverSide&&n.columns.forEach((function(e){e.render=function(e,a,n,r){return t.renderData(a,n,r)}})),n.initComplete=function(a,r){var o=t.el,c=o.DataTable(),i=t;t.json=r||void 0,t.bindClickHandlersAfterDraw(n),c.columns().every((function(t){var r=e(this.header()),l=r.html();if(r.html("<div class='data-table__header-wrapper position-relative ".concat(this.search()?"filter":"","' data-ddl='ddl_").concat(t,"'>").concat(l,"</div>")),r.hasClass("sorting")&&i.addSortButton(c,this),n.serverSide&&o.hasClass("table-search")){var s=a.oAjaxData.columns[t].name;i.searchParams.has(s)&&this.search(i.searchParams.get(s)).draw(),i.addSearchDropdown(this,s,t)}}))},n.drawCallback=function(e){t.bindClickHandlersAfterDraw(n)},n}},{key:"bindClickHandlersAfterDraw",value:function(t){var a=this,o=this.el,c=e(o).data("href")?e(o).data("href"):void 0;if(this.json&&c&&e(o).find("> tbody > tr").each((function(t,n){var r=a.json.data[t]?a.json.data[t]:void 0;if(r){var o=r._id?"".concat(c,"/").concat(r._id):"?".concat(r._count.url);e(n).find('td:not(".dtr-control")').on("click",(function(e){e.target.closest(".record-popup")||(window.location=o)}))}})),t.serverSide){var i=e(o).find(":not(.more-less) > .trigger[aria-expanded]");i.off("click",r.a),i.on("click",r.a),Object(n.d)(this.element)}}}])&&i(a.prototype,d),u&&i(a,u),Object.defineProperty(a,"prototype",{writable:!1}),h}(n.a);t.default=f}.call(this,a(1))}}]);