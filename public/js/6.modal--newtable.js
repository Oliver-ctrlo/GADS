(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{297:function(t,e,i){"use strict";var n=i(7),r=i(122).trim;n({target:"String",proto:!0,forced:i(298)("trim")},{trim:function(){return r(this)}})},298:function(t,e,i){var n=i(78).PROPER,r=i(6),a=i(124);t.exports=function(t){return r((function(){return!!a[t]()||"​᠎"!=="​᠎"[t]()||n&&a[t].name!==t}))}},308:function(t,e,i){var n=i(7),r=i(309).entries;n({target:"Object",stat:!0},{entries:function(t){return r(t)}})},309:function(t,e,i){var n=i(25),r=i(8),a=i(102),o=i(35),c=r(i(130).f),s=r([].push),l=function(t){return function(e){for(var i,r=o(e),l=a(r),d=l.length,u=0,f=[];d>u;)i=l[u++],n&&!c(r,i)||s(f,t?[i,r[i]]:r[i]);return f}};t.exports={entries:l(!0),values:l(!1)}},537:function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"b",(function(){return a}));i(20),i(3);var n=function(t,e){e.DataTable().row.add(t).draw()},r=function(e,i,n){i.find("tbody > tr").each((function(r,a){t(a).has("button[data-tempid=".concat(n,"]")).length&&i.DataTable().row(r).data(e).draw()}))},a=function(t){t.DataTable().clear().draw()}}).call(this,i(1))},826:function(t,e,i){"use strict";i.r(e),function(t){i(20),i(3),i(99),i(208),i(205),i(31),i(9),i(10),i(308),i(98),i(104),i(297),i(15),i(16),i(221),i(144),i(12),i(13),i(14),i(11),i(2),i(4),i(5),i(204),i(216),i(72);var n=i(88),r=i(537),a=i(30),o=i(89);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,a,o,c=[],s=!0,l=!1;try{if(a=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;s=!1}else for(;!(s=(n=a.call(i)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,r=t}finally{try{if(!s&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(l)throw r}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,a=void 0,a=function(t,e){if("object"!==c(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===c(a)?a:String(a)),n)}var r,a}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=f(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}}).apply(this,arguments)}function f(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}function p(t,e){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=m(t);if(e){var r=m(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b(this,i)}}function b(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(f,e);var i,n,c,l=h(f);function f(e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(i=l.call(this,e)).el=t(i.element),i.json={},i.fieldOptions=i.el.find(".modal-body .field-options"),i.topicsTable=i.el.find("#topics"),i.fieldsTable=i.el.find("#fields"),i.selectTopic=i.el.find(".modal-body .select--js-topic")[0],i.selectTopicComponent=new o.a(i.selectTopic),i.currentFieldObject={},i.currentTopicObject={},i.initNewTable(i.el),i}return i=f,(n=[{key:"initNewTable",value:function(t){var e=this.el.find(".modal-body .btn-js-create-topic"),i=this.el.find(".modal-body .btn-js-create-field");e.on("click",(function(t){a.a.activate(4,!0)})),i.on("click",(function(t){a.a.activate(7,!0)})),this.fieldOptions.addClass("hidden"),this.setupDataObject()}},{key:"setupDataObject",value:function(){this.json={table_permissions:[],topics:[],fields:[]}}},{key:"addFieldsToObject",value:function(e,i){return e.each((function(e,n){t(n).val()&&("checkbox"==t(n).prop("type")?t(n).prop("checked")?i[t(n).attr("name")]=!0:i[t(n).attr("name")]=!1:"topic_tempid"===t(n).attr("name")?i[t(n).attr("name")]=parseInt(t(n).val()):i[t(n).attr("name")]=t(n).val())})),i}},{key:"addTopic",value:function(e){var i=this,n=e.find("input, textarea");if(0===Object.keys(this.currentTopicObject).length){var a={tempId:this.uniqueID()};a=this.addFieldsToObject(n,a),this.currentTopicObject=a,this.json.topics.push(a),this.selectTopicComponent.addOption(a.name,a.tempId);var o=['<button class="btn btn-link btn-js-edit-topic" type="button" data-tempid="'.concat(a.tempId,'">').concat(a.name,"</button>"),a.description||"",a.expanded,""];r.a(o,this.topicsTable),this.addHandlerToEditItemButton("topic")}else{var c=this.json.topics.find((function(t){return t.tempId===i.currentTopicObject.tempId}));n.each((function(e,i){t(i).val()&&(c[t(i).attr("name")]=t(i).val())}));var s=['<button class="btn btn-link btn-js-edit-topic" type="button" data-tempid="'.concat(this.currentTopicObject.tempId,'">').concat(this.currentTopicObject.name,"</button>"),this.currentTopicObject.description||"",this.currentTopicObject.expanded,""];r.c(s,this.topicsTable,this.currentTopicObject.tempId),this.selectTopicComponent.updateOption(this.currentTopicObject.name,this.currentTopicObject.tempId),this.addHandlerToEditItemButton("topic")}}},{key:"fillFields",value:function(t,e){for(var i=0,n=Object.entries(e);i<n.length;i++){var r=s(n[i],2),a=r[0],o=r[1],c=t.find("[name=".concat(a,"]"));c&&("checkbox"===c.prop("type")&&!0===o?c.prop("checked",!0):"hidden"===c.prop("type")?(c.val(o),c.trigger("change")):(c.val(o),c.trigger("blur")))}}},{key:"editTopic",value:function(e,i){this.currentTopicObject=e,this.fillFields(t(i),e)}},{key:"editField",value:function(e,i){var n=this;this.currentFieldObject=e,a.a.clear([8,9]),this.fillFields(t(i),e);var r=e.field_type,o=u(m(f.prototype),"getFrameByNumber",this).call(this,8),c=t(o).find("[id=field_type_".concat(r,"]"));this.fillFields(c,e.field_type_settings);var s=e.custom_field_permissions,l=u(m(f.prototype),"getFrameByNumber",this).call(this,9);s.forEach((function(e){var i=e.group_id,r=t(l).find("tr[data-group-id=".concat(i,"]"));n.fillFields(r,e.permissions)}))}},{key:"removeNode",value:function(t,e){return e.filter((function(e){return e.tempId!==t}))}},{key:"addHandlerToEditItemButton",value:function(e){var i=this.el.find(".modal-body .btn-js-edit-".concat(e));i.off("click");var n="topic"===e?4:7;i.each((function(e,i){var r=t(i).data("tempid");t(i).on("click",(function(t){a.a.activate(n,!0,r)}))}))}},{key:"uniqueID",value:function(){return Math.floor(Math.random()*Date.now())}},{key:"addField",value:function(e){var i=this,n=e.find("input, textarea");if(0===Object.keys(this.currentFieldObject).length){var a={tempId:this.uniqueID(),custom_field_permissions:[],field_type_settings:{}};a=this.addFieldsToObject(n,a),this.currentFieldObject=a,this.json.fields.push(a);var o=['<button class="btn btn-link btn-js-edit-field" type="button" data-tempid="'.concat(a.tempId,'">').concat(a.name,"</button>"),a.name,a.topic||"",a["field-type"],""];r.a(o,this.fieldsTable),this.addHandlerToEditItemButton("field")}else{var c=this.json.fields.find((function(t){return t.tempId===i.currentFieldObject.tempId}));n.each((function(e,i){t(i).val()&&(c[t(i).attr("name")]=t(i).val())}));var s=['<button class="btn btn-link btn-js-edit-field" type="button" data-tempid="'.concat(this.currentFieldObject.tempId,'">').concat(this.currentFieldObject.name,"</button>"),this.currentFieldObject.name,this.currentFieldObject.topic||"",this.currentFieldObject["field-type"],""];r.c(s,this.fieldsTable,this.currentFieldObject.tempId),this.addHandlerToEditItemButton("field")}}},{key:"addFieldTypeSettings",value:function(e){var i=this,n=e.find("[id^=field_type_].select-reveal__instance:visible"),r=n.find("input, textarea"),a=this.json.fields.find((function(t){return t.tempId===i.currentFieldObject.tempId}));switch(n.attr("id")){case"field_type_enum":var o=n.find('input[name="ordering"]'),c=n.find(".sortable input"),s={dropdown_values:[],ordering:o.val()};c.each((function(e,i){var n={};n[t(i).attr("name")]=t(i).val(),s.dropdown_values.push(n)})),a.field_type_settings=s;break;case"field_type_tree":var l=n.find(".tree-widget-container"),d={data:{},dataJson:{}};if(l.length){var u=l.jstree(!0).get_json("#",{flat:!1}),f=(JSON.stringify(u),l.data().jstree._model.data);d.data=f,d.dataJson=u}d=this.addFieldsToObject(r,d),a.field_type_settings=d;break;case"field_type_curval":var p=n.find('input[name="curval_field_ids"]:visible'),h=n.find('input:not([name="curval_field_ids"]), textarea'),b={curval_field_ids:[]};p.each((function(e,i){t(i).val()&&b.curval_field_ids.push(t(i).val())})),b=this.addFieldsToObject(h,b),a.field_type_settings=b;break;default:var m={};m=this.addFieldsToObject(r,m),a.field_type_settings=m}}},{key:"addTable",value:function(e){var i=e.find("input, textarea"),n=this.el.find(".modal-title"),r=this;i.each((function(e,i){t(i).val()&&(r.json[t(i).attr("name")]=t(i).val())})),this.json.name&&n.html("Table setup | ".concat(this.json.name))}},{key:"addCustomFieldPermissions",value:function(e){var i=this,n=this,r=e.find("#custom_field_permissions_table").DataTable().rows(),a=n.json.fields.find((function(t){return t.tempId===i.currentFieldObject.tempId}));a.custom_field_permissions=[],r.every((function(e){var i=this.nodes()[0],r=i.dataset.groupId,o=t(i).find("td")[0].innerHTML.trim(),c=t(i).find("input"),s={group_id:r,group_name:o,permissions:{}};s.permissions=n.addFieldsToObject(c,s.permissions),a.custom_field_permissions.push(s)}))}},{key:"addTablePermissions",value:function(e){var i=this,n=e.find(".card--expandable"),r=this;n.each((function(e,n){var a=t(n).closest(".permission-group"),o=a&&void 0!==a.data("group-id")?a.data("group-id"):"",c=t(n).find(".card__subtitle")[0].innerHTML.trim(),s=t(n).find("fieldset"),l={group_id:o,group_name:c,records:{},views:{},fields:{}};s.each((function(e,n){var r=t(n).data("name"),a=t(n).find("input");l[r]=i.addFieldsToObject(a,l[r])})),r.json.table_permissions.push(l)}))}},{key:"handleNext",value:function(e){switch(u(m(f.prototype),"handleNext",this).call(this),e.data("config").item){case"topic":this.addTopic(e);break;case"field":this.addField(e);break;case"field type settings":this.addFieldTypeSettings(e),this.recalculateDatatableColumnWidths(t("#custom_field_permissions_table"));break;case"custom field permissions":this.addCustomFieldPermissions(e);break;case"table":this.addTable(e);break;case"table permissions":this.addTablePermissions(e);break;default:var i=e.find("input, textarea");this.addFieldsToObject(i,this.json)}}},{key:"recalculateDatatableColumnWidths",value:function(t){t.DataTable().columns.adjust()}},{key:"handleBack",value:function(t){u(m(f.prototype),"handleBack",this).call(this)}},{key:"handleSave",value:function(){a.a.upload(this.json)}},{key:"handleUpdate",value:function(t){"topic"===t.data("config").item?(this.addTopic(t),this.currentTopicObject={}):"field"===t.data("config").item&&(this.addField(t),this.currentFieldObject={})}},{key:"handleActivate",value:function(t,e,i){if(u(m(f.prototype),"handleActivate",this).call(this,t,e),7===t&&i){var n=u(m(f.prototype),"getFrameByNumber",this).call(this,t),r=this.json.fields.find((function(t){return t.tempId===i}));this.editField(r,n)}else if(7===t&&e)this.currentFieldObject={},a.a.clear([8,9]);else if(4===t&&i){var o=u(m(f.prototype),"getFrameByNumber",this).call(this,t),c=this.json.topics.find((function(t){return t.tempId===i}));this.editTopic(c,o)}else 4===t&&e&&(this.currentTopicObject={});u(m(f.prototype),"validateFrame",this).call(this)}},{key:"handleClose",value:function(){var t=this;this.el.find(".collapse").collapse("hide"),this.topicsTable&&r.b(this.topicsTable),this.fieldsTable&&r.b(this.fieldsTable),this.selectTopicComponent.options.each((function(e,i){t.selectTopicComponent.removeOption(parseInt(i.dataset.value))})),this.setupDataObject(),this.currentFieldObject={},this.currentTopicObject={},u(m(f.prototype),"handleClose",this).call(this)}}])&&d(i.prototype,n),c&&d(i,c),Object.defineProperty(i,"prototype",{writable:!1}),f}(n.a);e.default=v}.call(this,i(1))}}]);